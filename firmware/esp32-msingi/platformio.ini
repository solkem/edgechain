; Msingi ESP32-S3 Firmware
; PlatformIO configuration for EdgeChain IoT devices
;
; Hardware:
;   - ESP32-S3-WROOM-1-N16R8 (16MB Flash, 8MB PSRAM)
;   - ATECC608B Secure Element (I2C)
;   - RYLR896 LoRa Transceiver (UART)
;   - BME280 Environmental Sensor (I2C)
;   - Capacitive Soil Moisture Sensor (ADC)

[env:esp32s3-msingi]
platform = espressif32
board = esp32-s3-devkitc-1
framework = arduino

; Build options
build_flags = 
    -DCORE_DEBUG_LEVEL=3
    -DBOARD_HAS_PSRAM
    -DARDUINO_USB_MODE=1
    -DARDUINO_USB_CDC_ON_BOOT=1
    ; Security flags
    -DENABLE_ATECC608B=1
    -DENABLE_LORA=1
    ; Network configuration
    -DLORA_FREQUENCY=868000000
    -DLORA_SPREADING_FACTOR=10
    -DLORA_BANDWIDTH=125

; Library dependencies
lib_deps = 
    ; ATECC608B secure element
    sparkfun/SparkFun ATECCX08a Arduino Library@^1.0.8
    ; BME280 environmental sensor
    adafruit/Adafruit BME280 Library@^2.2.2
    adafruit/Adafruit Unified Sensor@^1.1.7
    ; Cryptography
    rweather/Crypto@^0.4.0
    ; JSON handling
    bblanchon/ArduinoJson@^6.21.3

; Serial monitor
monitor_speed = 115200
monitor_filters = esp32_exception_decoder

; Upload settings
upload_speed = 921600

; Memory partitions (16MB flash)
board_build.partitions = default_16MB.csv
board_build.arduino.memory_type = qio_opi

; Additional build settings
; -Wno-missing-field-initializers suppresses common struct warnings
build_unflags = -Werror=all
extra_scripts = pre:scripts/version.py
